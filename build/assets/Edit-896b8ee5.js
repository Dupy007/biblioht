import{_ as b,j as y,o as d,c as l,a as t,F as u,r as m,t as p,d as _,b as f,i as v,w as g,v as k}from"./app-7be19962.js";const w={name:"update-pyramid",data(){return{userpyramid:{id:null,user_id:null,pyramid_id:null,position:null,_method:"patch"},userpyramids:{},users:[],errors:[],intervalid1:null,changes:null,iscomplete:!1,isend:!1,pyramid_id:null}},mounted(){this.showuserpyramid(),this.getUsers()},methods:{async showuserpyramid(){await axios.get("/plf/userpyramid/"+this.$route.params.id).then(s=>{this.iscomplete=s.data.iscomplete,this.isend=s.data.isend;let e=s.data.userpyramid;for(let r=1;r<16;r++){let a={user_id:null,pyramid_id:e[1].pyramid_id,position:r,_method:"patch"};this.pyramid_id=e[1].pyramid_id,e[r]&&(a.id=e[r].pyramid_user_id,a.user_id=e[r].user_id),this.userpyramids[r]=a}}).catch(s=>{console.log(s)})},async update(s){await axios.post("/plf/userpyramid/"+s.id,s).then(e=>{this.setBackgroundColor("s")}).catch(e=>{this.setBackgroundColor("f");var r=[];r=e.response.data.errors;for(const a in r)if(Object.hasOwnProperty.call(r,a)){const o=r[a];this.errors.push(o[0])}console.log(e)})},async getUsers(){await axios.get("/plf/user").then(s=>{this.users=s.data}).catch(s=>{console.log(s),this.users=[]})},checkForm:function(s){for(const e in this.userpyramids)if(Object.hasOwnProperty.call(this.userpyramids,e)){const r=this.userpyramids[e];r.user_id&&this.update(r)}this.showuserpyramid(),s.preventDefault()},setBackgroundColor(s){var e=y("#f00000");s=="s"&&(e=y("#00f000")),document.querySelector("body").style.backgroundColor=e.value,setTimeout(()=>{document.querySelector("body").style.backgroundColor=null},3e3)},async endpyramid(){await axios.get("/plf/endpyramid/"+this.pyramid_id).then(s=>{}).catch(s=>{console.log(s),this.userpyramids=[]})}}},x={class:"row"},C={class:"col-12"},U={class:"card"},B=t("div",{class:"card-header"},[t("h4",null,"Update Pyramid")],-1),S={class:"card-body"},F={class:"row"},P={key:0},V=t("b",null,"Please correct the following error(s):",-1),O={class:"col-12 mb-2"},j=t("h5",null,"User",-1),D=["onUpdate:modelValue"],M=t("option",null,null,-1),q=["value"],E=t("div",{class:"col-12 mb-2"},[t("button",{type:"submit",class:"btn btn-primary"},"Update")],-1),N=t("div",{class:"col-12 mb-2"},[t("button",{type:"submit",class:"btn btn-primary"},"Confirm the end of the pyramid")],-1);function T(s,e,r,a,o,n){return d(),l("div",x,[t("div",C,[t("div",U,[B,t("div",S,[t("form",{onSubmit:e[0]||(e[0]=(...i)=>n.checkForm&&n.checkForm(...i))},[t("div",F,[o.errors.length?(d(),l("p",P,[V,t("ul",null,[(d(!0),l(u,null,m(o.errors,i=>(d(),l("li",null,p(i),1))),256))])])):_("",!0),t("div",O,[j,(d(!0),l(u,null,m(o.userpyramids,(i,h)=>(d(),l("div",{class:"form-group",key:h},[t("label",null,"Position "+p(h),1),f(t("select",{class:"form-select","onUpdate:modelValue":c=>i.user_id=c},[M,(d(!0),l(u,null,m(o.users,c=>(d(),l("option",{value:c.id},p(c.name),9,q))),256))],8,D),[[v,i.user_id]])]))),128))]),E])],32),!o.isend&&o.iscomplete?(d(),l("form",{key:0,onSubmit:e[2]||(e[2]=g((...i)=>n.endpyramid&&n.endpyramid(...i),["prevent"]))},[f(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=i=>o.pyramid_id=i),hidden:""},null,512),[[k,o.pyramid_id]]),N],32)):_("",!0)])])])])}const z=b(w,[["render",T]]);export{z as default};
